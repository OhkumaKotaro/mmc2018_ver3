ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"control.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.global	__aeabi_f2d
  18              		.global	__aeabi_dmul
  19              		.global	__aeabi_dadd
  20              		.global	__aeabi_d2f
  21              		.section	.text.PID_value,"ax",%progbits
  22              		.align	1
  23              		.global	PID_value
  24              		.syntax unified
  25              		.thumb
  26              		.thumb_func
  27              		.fpu fpv4-sp-d16
  29              	PID_value:
  30              	.LFB126:
  31              		.file 1 "Src/control.c"
   1:Src/control.c **** #include "control.h"
   2:Src/control.c **** #include "tim.h"
   3:Src/control.c **** #include "stdint.h"
   4:Src/control.c **** #include "filter.h"
   5:Src/control.c **** #include "spi.h"
   6:Src/control.c **** #include "interface.h"
   7:Src/control.c **** 
   8:Src/control.c **** #define TRUE 1
   9:Src/control.c **** #define FALSE 0
  10:Src/control.c **** 
  11:Src/control.c **** #define ON 1
  12:Src/control.c **** #define OFF
  13:Src/control.c **** 
  14:Src/control.c **** #define dt 0.001
  15:Src/control.c **** 
  16:Src/control.c **** typedef struct
  17:Src/control.c **** {
  18:Src/control.c ****     int16_t velocity;
  19:Src/control.c ****     int16_t accel;
  20:Src/control.c ****     int8_t dir;
  21:Src/control.c **** } target_t;
  22:Src/control.c **** target_t straight_tgt;
  23:Src/control.c **** target_t yawrate_tgt;
  24:Src/control.c **** 
  25:Src/control.c **** typedef struct
  26:Src/control.c **** {
  27:Src/control.c ****     uint16_t up;
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 2


  28:Src/control.c ****     uint16_t cons;
  29:Src/control.c ****     uint16_t down;
  30:Src/control.c **** } trapezoid_tim_t;
  31:Src/control.c **** trapezoid_tim_t straight_tim;
  32:Src/control.c **** trapezoid_tim_t yawrate_tim;
  33:Src/control.c **** 
  34:Src/control.c **** extern enc_t enc;
  35:Src/control.c **** extern gyro_t gyro;
  36:Src/control.c **** 
  37:Src/control.c **** extern sensor_t sen_l;
  38:Src/control.c **** extern sensor_t sen_fl;
  39:Src/control.c **** extern sensor_t sen_front;
  40:Src/control.c **** extern sensor_t sen_fr;
  41:Src/control.c **** extern sensor_t sen_r;
  42:Src/control.c **** 
  43:Src/control.c **** float enc_sum;
  44:Src/control.c **** float enc_before;
  45:Src/control.c **** 
  46:Src/control.c **** float y_sum;
  47:Src/control.c **** float y_before;
  48:Src/control.c **** 
  49:Src/control.c **** float fwall_error_s = 0;
  50:Src/control.c **** float fwall_error_y = 0;
  51:Src/control.c **** 
  52:Src/control.c **** volatile unsigned char flag_motion_end;
  53:Src/control.c **** uint8_t flag_motor;
  54:Src/control.c **** unsigned char flag_wall;
  55:Src/control.c **** volatile unsigned char flag_front_wall;
  56:Src/control.c **** 
  57:Src/control.c **** unsigned char add_l = 0, add_r = 0;
  58:Src/control.c **** 
  59:Src/control.c **** /****************************************************************************************
  60:Src/control.c ****  * outline  : PID control
  61:Src/control.c ****  * argument : 
  62:Src/control.c ****  * return   : control value
  63:Src/control.c **** ********************************************************************************************/
  64:Src/control.c **** float PID_value(float target, float measured, float *sum, float *old, float Kp, float Ki, float Kd)
  65:Src/control.c **** {
  32              		.loc 1 65 0
  33              		.cfi_startproc
  34              		@ args = 0, pretend = 0, frame = 0
  35              		@ frame_needed = 0, uses_anonymous_args = 0
  36              	.LVL0:
  37 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
  38              	.LCFI0:
  39              		.cfi_def_cfa_offset 24
  40              		.cfi_offset 3, -24
  41              		.cfi_offset 4, -20
  42              		.cfi_offset 5, -16
  43              		.cfi_offset 6, -12
  44              		.cfi_offset 7, -8
  45              		.cfi_offset 14, -4
  46 0002 2DED048B 		vpush.64	{d8, d9}
  47              	.LCFI1:
  48              		.cfi_def_cfa_offset 40
  49              		.cfi_offset 80, -40
  50              		.cfi_offset 81, -36
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 3


  51              		.cfi_offset 82, -32
  52              		.cfi_offset 83, -28
  53 0006 0546     		mov	r5, r0
  54 0008 0C46     		mov	r4, r1
  55 000a F0EE619A 		vmov.f32	s19, s3
  56 000e B0EE429A 		vmov.f32	s18, s4
  66:Src/control.c ****     float error;
  67:Src/control.c ****     float p, i, d;
  68:Src/control.c **** 
  69:Src/control.c ****     error = target - measured;
  57              		.loc 1 69 0
  58 0012 30EE608A 		vsub.f32	s16, s0, s1
  59              	.LVL1:
  70:Src/control.c ****     p = Kp * error;
  60              		.loc 1 70 0
  61 0016 68EE018A 		vmul.f32	s17, s16, s2
  62              	.LVL2:
  71:Src/control.c **** 
  72:Src/control.c ****     *sum += error * dt;
  63              		.loc 1 72 0
  64 001a 18EE100A 		vmov	r0, s16
  65              	.LVL3:
  66 001e FFF7FEFF 		bl	__aeabi_f2d
  67              	.LVL4:
  68 0022 13A3     		adr	r3, .L3
  69 0024 D3E90023 		ldrd	r2, [r3]
  70 0028 FFF7FEFF 		bl	__aeabi_dmul
  71              	.LVL5:
  72 002c 0646     		mov	r6, r0
  73 002e 0F46     		mov	r7, r1
  74 0030 2868     		ldr	r0, [r5]	@ float
  75 0032 FFF7FEFF 		bl	__aeabi_f2d
  76              	.LVL6:
  77 0036 3246     		mov	r2, r6
  78 0038 3B46     		mov	r3, r7
  79 003a FFF7FEFF 		bl	__aeabi_dadd
  80              	.LVL7:
  81 003e FFF7FEFF 		bl	__aeabi_d2f
  82              	.LVL8:
  83 0042 00EE100A 		vmov	s0, r0
  84 0046 2860     		str	r0, [r5]	@ float
  73:Src/control.c ****     i = *sum * Ki;
  85              		.loc 1 73 0
  86 0048 20EE290A 		vmul.f32	s0, s0, s19
  87              	.LVL9:
  74:Src/control.c **** 
  75:Src/control.c ****     d = Kd * (error - *old);
  88              		.loc 1 75 0
  89 004c 94ED002A 		vldr.32	s4, [r4]
  90 0050 38EE422A 		vsub.f32	s4, s16, s4
  91 0054 22EE092A 		vmul.f32	s4, s4, s18
  92              	.LVL10:
  76:Src/control.c ****     *old = error;
  93              		.loc 1 76 0
  94 0058 84ED008A 		vstr.32	s16, [r4]
  77:Src/control.c **** 
  78:Src/control.c ****     return (p + i + d);
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 4


  95              		.loc 1 78 0
  96 005c 38EE800A 		vadd.f32	s0, s17, s0
  97              	.LVL11:
  79:Src/control.c **** }
  98              		.loc 1 79 0
  99 0060 30EE020A 		vadd.f32	s0, s0, s4
 100 0064 BDEC048B 		vldm	sp!, {d8-d9}
 101              	.LCFI2:
 102              		.cfi_restore 82
 103              		.cfi_restore 83
 104              		.cfi_restore 80
 105              		.cfi_restore 81
 106              		.cfi_def_cfa_offset 24
 107              	.LVL12:
 108 0068 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 109              	.LVL13:
 110              	.L4:
 111 006a 00BFAFF3 		.align	3
 111      0080
 112              	.L3:
 113 0070 FCA9F1D2 		.word	-755914244
 114 0074 4D62503F 		.word	1062232653
 115              		.cfi_endproc
 116              	.LFE126:
 118              		.section	.text.Straight_Calc_fb,"ax",%progbits
 119              		.align	1
 120              		.global	Straight_Calc_fb
 121              		.syntax unified
 122              		.thumb
 123              		.thumb_func
 124              		.fpu fpv4-sp-d16
 126              	Straight_Calc_fb:
 127              	.LFB127:
  80:Src/control.c **** 
  81:Src/control.c **** /****************************************************************************************
  82:Src/control.c ****  * outline  : calcurate accele distance
  83:Src/control.c ****  * argument : distance[mm],v_start[mm/s],v_end[mm/s]
  84:Src/control.c ****  * return   : void
  85:Src/control.c **** ********************************************************************************************/
  86:Src/control.c **** void Straight_Calc_fb(int16_t distant, int16_t v_start, int16_t v_end, uint16_t v_max, uint16_t acc
  87:Src/control.c **** {
 128              		.loc 1 87 0
 129              		.cfi_startproc
 130              		@ args = 4, pretend = 0, frame = 0
 131              		@ frame_needed = 0, uses_anonymous_args = 0
 132              		@ link register save eliminated.
 133              	.LVL14:
 134 0000 70B4     		push	{r4, r5, r6}
 135              	.LCFI3:
 136              		.cfi_def_cfa_offset 12
 137              		.cfi_offset 4, -12
 138              		.cfi_offset 5, -8
 139              		.cfi_offset 6, -4
 140 0002 BDF80C40 		ldrh	r4, [sp, #12]
  88:Src/control.c ****     float t1, t2, t3;
  89:Src/control.c ****     float constant_L;
  90:Src/control.c **** 
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 5


  91:Src/control.c ****     enc_before = 0;
 141              		.loc 1 91 0
 142 0006 0025     		movs	r5, #0
 143 0008 354E     		ldr	r6, .L12
 144 000a 3560     		str	r5, [r6]	@ float
  92:Src/control.c ****     y_before = 0;
 145              		.loc 1 92 0
 146 000c 354E     		ldr	r6, .L12+4
 147 000e 3560     		str	r5, [r6]	@ float
  93:Src/control.c **** 
  94:Src/control.c ****     straight_tgt.velocity = v_start;
 148              		.loc 1 94 0
 149 0010 354D     		ldr	r5, .L12+8
 150 0012 2980     		strh	r1, [r5]	@ movhi
  95:Src/control.c ****     straight_tgt.accel = accel;
 151              		.loc 1 95 0
 152 0014 6C80     		strh	r4, [r5, #2]	@ movhi
  96:Src/control.c **** 
  97:Src/control.c ****     if (distant < 0)
 153              		.loc 1 97 0
 154 0016 0028     		cmp	r0, #0
 155              	.LVL15:
 156 0018 07DB     		blt	.L10
  98:Src/control.c ****     {
  99:Src/control.c ****         distant = -1 * distant;
 100:Src/control.c ****         straight_tgt.dir = -1;
 101:Src/control.c ****     }
 102:Src/control.c ****     else if (distant == 0)
 157              		.loc 1 102 0
 158 001a 0028     		cmp	r0, #0
 159 001c 5AD0     		beq	.L11
 103:Src/control.c ****     {
 104:Src/control.c ****         straight_tgt.dir = 0;
 105:Src/control.c ****         accel = 1;
 106:Src/control.c ****         v_max = 1;
 107:Src/control.c ****     }
 108:Src/control.c ****     else if (distant > 0)
 160              		.loc 1 108 0
 161 001e 0028     		cmp	r0, #0
 162 0020 07DD     		ble	.L7
 109:Src/control.c ****     {
 110:Src/control.c ****         straight_tgt.dir = 1;
 163              		.loc 1 110 0
 164 0022 314D     		ldr	r5, .L12+8
 165 0024 0126     		movs	r6, #1
 166 0026 2E71     		strb	r6, [r5, #4]
 167 0028 03E0     		b	.L7
 168              	.L10:
  99:Src/control.c ****         straight_tgt.dir = -1;
 169              		.loc 1 99 0
 170 002a 4042     		negs	r0, r0
 171 002c 00B2     		sxth	r0, r0
 172              	.LVL16:
 100:Src/control.c ****     }
 173              		.loc 1 100 0
 174 002e FF26     		movs	r6, #255
 175 0030 2E71     		strb	r6, [r5, #4]
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 6


 176              	.LVL17:
 177              	.L7:
 111:Src/control.c ****     }
 112:Src/control.c **** 
 113:Src/control.c ****     t1 = (float)(v_max - v_start) / accel;
 178              		.loc 1 113 0
 179 0032 5D1A     		subs	r5, r3, r1
 180 0034 07EE105A 		vmov	s14, r5	@ int
 181 0038 B8EEC77A 		vcvt.f32.s32	s14, s14
 182 003c 07EE904A 		vmov	s15, r4	@ int
 183 0040 F8EEE77A 		vcvt.f32.s32	s15, s15
 184 0044 87EE276A 		vdiv.f32	s12, s14, s15
 185              	.LVL18:
 114:Src/control.c ****     t3 = (float)(v_max - v_end) / accel;
 186              		.loc 1 114 0
 187 0048 9C1A     		subs	r4, r3, r2
 188              	.LVL19:
 189 004a 07EE104A 		vmov	s14, r4	@ int
 190 004e B8EEC77A 		vcvt.f32.s32	s14, s14
 191 0052 C7EE276A 		vdiv.f32	s13, s14, s15
 192              	.LVL20:
 115:Src/control.c **** 
 116:Src/control.c ****     constant_L = (float)distant - (v_max + v_start) * t1 / 2 - (v_max + v_end) * t3 / 2;
 193              		.loc 1 116 0
 194 0056 07EE900A 		vmov	s15, r0	@ int
 195 005a B8EEE77A 		vcvt.f32.s32	s14, s15
 196 005e 5918     		adds	r1, r3, r1
 197              	.LVL21:
 198 0060 07EE901A 		vmov	s15, r1	@ int
 199 0064 F8EEE77A 		vcvt.f32.s32	s15, s15
 200 0068 67EE867A 		vmul.f32	s15, s15, s12
 201 006c F6EE005A 		vmov.f32	s11, #5.0e-1
 202 0070 67EEA57A 		vmul.f32	s15, s15, s11
 203 0074 77EE677A 		vsub.f32	s15, s14, s15
 204 0078 9A18     		adds	r2, r3, r2
 205              	.LVL22:
 206 007a 07EE102A 		vmov	s14, r2	@ int
 207 007e B8EEC77A 		vcvt.f32.s32	s14, s14
 208 0082 27EE267A 		vmul.f32	s14, s14, s13
 209 0086 27EE257A 		vmul.f32	s14, s14, s11
 210 008a 37EEC77A 		vsub.f32	s14, s15, s14
 211              	.LVL23:
 117:Src/control.c **** 
 118:Src/control.c ****     t2 = constant_L / v_max;
 212              		.loc 1 118 0
 213 008e 07EE903A 		vmov	s15, r3	@ int
 214 0092 F8EEE77A 		vcvt.f32.s32	s15, s15
 215 0096 C7EE275A 		vdiv.f32	s11, s14, s15
 216              	.LVL24:
 119:Src/control.c **** 
 120:Src/control.c ****     t1 *= 1000;
 217              		.loc 1 120 0
 218 009a 9FED147A 		vldr.32	s14, .L12+12
 219              	.LVL25:
 220 009e 26EE076A 		vmul.f32	s12, s12, s14
 221              	.LVL26:
 121:Src/control.c ****     t2 *= 1000;
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 7


 222              		.loc 1 121 0
 223 00a2 65EE877A 		vmul.f32	s15, s11, s14
 224              	.LVL27:
 122:Src/control.c ****     t3 *= 1000;
 225              		.loc 1 122 0
 226 00a6 66EE876A 		vmul.f32	s13, s13, s14
 227              	.LVL28:
 123:Src/control.c **** 
 124:Src/control.c ****     straight_tim.up = t1;
 228              		.loc 1 124 0
 229 00aa 114B     		ldr	r3, .L12+16
 230              	.LVL29:
 231 00ac BCEEC66A 		vcvt.u32.f32	s12, s12
 232              	.LVL30:
 233 00b0 16EE102A 		vmov	r2, s12	@ int
 234 00b4 1A80     		strh	r2, [r3]	@ movhi
 125:Src/control.c ****     straight_tim.cons = t2;
 235              		.loc 1 125 0
 236 00b6 FCEEE77A 		vcvt.u32.f32	s15, s15
 237              	.LVL31:
 238 00ba 17EE902A 		vmov	r2, s15	@ int
 239 00be 5A80     		strh	r2, [r3, #2]	@ movhi
 126:Src/control.c ****     straight_tim.down = t3;
 240              		.loc 1 126 0
 241 00c0 FCEEE66A 		vcvt.u32.f32	s13, s13
 242              	.LVL32:
 243 00c4 16EE902A 		vmov	r2, s13	@ int
 244 00c8 9A80     		strh	r2, [r3, #4]	@ movhi
 127:Src/control.c **** 
 128:Src/control.c ****     flag_motion_end = FALSE;
 245              		.loc 1 128 0
 246 00ca 0A4B     		ldr	r3, .L12+20
 247 00cc 0022     		movs	r2, #0
 248 00ce 1A70     		strb	r2, [r3]
 129:Src/control.c **** 
 130:Src/control.c ****     //printf("%d %d %d\r\n",accel_T,constant_T,decrease_T);
 131:Src/control.c **** }
 249              		.loc 1 131 0
 250 00d0 70BC     		pop	{r4, r5, r6}
 251              	.LCFI4:
 252              		.cfi_remember_state
 253              		.cfi_restore 6
 254              		.cfi_restore 5
 255              		.cfi_restore 4
 256              		.cfi_def_cfa_offset 0
 257 00d2 7047     		bx	lr
 258              	.LVL33:
 259              	.L11:
 260              	.LCFI5:
 261              		.cfi_restore_state
 104:Src/control.c ****         accel = 1;
 262              		.loc 1 104 0
 263 00d4 044B     		ldr	r3, .L12+8
 264              	.LVL34:
 265 00d6 0024     		movs	r4, #0
 266 00d8 1C71     		strb	r4, [r3, #4]
 267              	.LVL35:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 8


 105:Src/control.c ****         v_max = 1;
 268              		.loc 1 105 0
 269 00da 0124     		movs	r4, #1
 106:Src/control.c ****     }
 270              		.loc 1 106 0
 271 00dc 2346     		mov	r3, r4
 272 00de A8E7     		b	.L7
 273              	.L13:
 274              		.align	2
 275              	.L12:
 276 00e0 00000000 		.word	enc_before
 277 00e4 00000000 		.word	y_before
 278 00e8 00000000 		.word	straight_tgt
 279 00ec 00007A44 		.word	1148846080
 280 00f0 00000000 		.word	straight_tim
 281 00f4 00000000 		.word	flag_motion_end
 282              		.cfi_endproc
 283              	.LFE127:
 285              		.section	.text.Yawrate_Calc_fb,"ax",%progbits
 286              		.align	1
 287              		.global	Yawrate_Calc_fb
 288              		.syntax unified
 289              		.thumb
 290              		.thumb_func
 291              		.fpu fpv4-sp-d16
 293              	Yawrate_Calc_fb:
 294              	.LFB128:
 132:Src/control.c **** 
 133:Src/control.c **** /****************************************************************************************
 134:Src/control.c ****  * outline  : calcurate trapezoid accel
 135:Src/control.c ****  * argument : degree[degree],v_start[degree/s],v_end[degree/s]
 136:Src/control.c ****  * return   : void
 137:Src/control.c **** ********************************************************************************************/
 138:Src/control.c **** void Yawrate_Calc_fb(int16_t degree, int16_t v_start, int16_t v_end, int16_t v_max, int16_t accel)
 139:Src/control.c **** {
 295              		.loc 1 139 0
 296              		.cfi_startproc
 297              		@ args = 4, pretend = 0, frame = 0
 298              		@ frame_needed = 0, uses_anonymous_args = 0
 299              		@ link register save eliminated.
 300              	.LVL36:
 301 0000 70B4     		push	{r4, r5, r6}
 302              	.LCFI6:
 303              		.cfi_def_cfa_offset 12
 304              		.cfi_offset 4, -12
 305              		.cfi_offset 5, -8
 306              		.cfi_offset 6, -4
 307 0002 BDF90C40 		ldrsh	r4, [sp, #12]
 308              	.LVL37:
 140:Src/control.c ****     float t1 = 0, t2 = 0, t3 = 0;
 141:Src/control.c ****     float constant_L;
 142:Src/control.c **** 
 143:Src/control.c ****     enc_before = 0;
 309              		.loc 1 143 0
 310 0006 0025     		movs	r5, #0
 311 0008 354E     		ldr	r6, .L21
 312 000a 3560     		str	r5, [r6]	@ float
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 9


 144:Src/control.c ****     y_before = 0;
 313              		.loc 1 144 0
 314 000c 354E     		ldr	r6, .L21+4
 315 000e 3560     		str	r5, [r6]	@ float
 145:Src/control.c **** 
 146:Src/control.c ****     yawrate_tgt.velocity = v_start;
 316              		.loc 1 146 0
 317 0010 354D     		ldr	r5, .L21+8
 318 0012 2980     		strh	r1, [r5]	@ movhi
 147:Src/control.c ****     yawrate_tgt.accel = accel;
 319              		.loc 1 147 0
 320 0014 6C80     		strh	r4, [r5, #2]	@ movhi
 148:Src/control.c **** 
 149:Src/control.c ****     if (degree < 0)
 321              		.loc 1 149 0
 322 0016 0028     		cmp	r0, #0
 323              	.LVL38:
 324 0018 07DB     		blt	.L19
 150:Src/control.c ****     {
 151:Src/control.c ****         degree = -1 * degree;
 152:Src/control.c ****         yawrate_tgt.dir = -1;
 153:Src/control.c ****     }
 154:Src/control.c ****     else if (degree == 0)
 325              		.loc 1 154 0
 326 001a 0028     		cmp	r0, #0
 327 001c 5AD0     		beq	.L20
 155:Src/control.c ****     {
 156:Src/control.c ****         yawrate_tgt.dir = 0;
 157:Src/control.c ****         accel = 1;
 158:Src/control.c ****         v_max = 1;
 159:Src/control.c ****     }
 160:Src/control.c ****     else if (degree > 0)
 328              		.loc 1 160 0
 329 001e 0028     		cmp	r0, #0
 330 0020 07DD     		ble	.L16
 161:Src/control.c ****     {
 162:Src/control.c ****         yawrate_tgt.dir = 1;
 331              		.loc 1 162 0
 332 0022 314D     		ldr	r5, .L21+8
 333 0024 0126     		movs	r6, #1
 334 0026 2E71     		strb	r6, [r5, #4]
 335 0028 03E0     		b	.L16
 336              	.L19:
 151:Src/control.c ****         yawrate_tgt.dir = -1;
 337              		.loc 1 151 0
 338 002a 4042     		negs	r0, r0
 339 002c 00B2     		sxth	r0, r0
 340              	.LVL39:
 152:Src/control.c ****     }
 341              		.loc 1 152 0
 342 002e FF26     		movs	r6, #255
 343 0030 2E71     		strb	r6, [r5, #4]
 344              	.LVL40:
 345              	.L16:
 163:Src/control.c ****     }
 164:Src/control.c **** 
 165:Src/control.c ****     t1 = (float)(v_max - v_start) / accel;
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 10


 346              		.loc 1 165 0
 347 0032 5D1A     		subs	r5, r3, r1
 348 0034 07EE105A 		vmov	s14, r5	@ int
 349 0038 B8EEC77A 		vcvt.f32.s32	s14, s14
 350 003c 07EE904A 		vmov	s15, r4	@ int
 351 0040 F8EEE77A 		vcvt.f32.s32	s15, s15
 352 0044 87EE276A 		vdiv.f32	s12, s14, s15
 353              	.LVL41:
 166:Src/control.c ****     t3 = (float)(v_max - v_end) / accel;
 354              		.loc 1 166 0
 355 0048 9C1A     		subs	r4, r3, r2
 356              	.LVL42:
 357 004a 07EE104A 		vmov	s14, r4	@ int
 358 004e B8EEC77A 		vcvt.f32.s32	s14, s14
 359 0052 C7EE276A 		vdiv.f32	s13, s14, s15
 360              	.LVL43:
 167:Src/control.c **** 
 168:Src/control.c ****     constant_L = (float)degree - (v_max + v_start) * t1 / 2 - (v_max + v_end) * t3 / 2;
 361              		.loc 1 168 0
 362 0056 07EE900A 		vmov	s15, r0	@ int
 363 005a B8EEE77A 		vcvt.f32.s32	s14, s15
 364 005e 5918     		adds	r1, r3, r1
 365              	.LVL44:
 366 0060 07EE901A 		vmov	s15, r1	@ int
 367 0064 F8EEE77A 		vcvt.f32.s32	s15, s15
 368 0068 67EE867A 		vmul.f32	s15, s15, s12
 369 006c F6EE005A 		vmov.f32	s11, #5.0e-1
 370 0070 67EEA57A 		vmul.f32	s15, s15, s11
 371 0074 77EE677A 		vsub.f32	s15, s14, s15
 372 0078 9A18     		adds	r2, r3, r2
 373              	.LVL45:
 374 007a 07EE102A 		vmov	s14, r2	@ int
 375 007e B8EEC77A 		vcvt.f32.s32	s14, s14
 376 0082 27EE267A 		vmul.f32	s14, s14, s13
 377 0086 27EE257A 		vmul.f32	s14, s14, s11
 378 008a 37EEC77A 		vsub.f32	s14, s15, s14
 379              	.LVL46:
 169:Src/control.c **** 
 170:Src/control.c ****     t2 = constant_L / v_max;
 380              		.loc 1 170 0
 381 008e 07EE903A 		vmov	s15, r3	@ int
 382 0092 F8EEE77A 		vcvt.f32.s32	s15, s15
 383 0096 C7EE275A 		vdiv.f32	s11, s14, s15
 384              	.LVL47:
 171:Src/control.c **** 
 172:Src/control.c ****     t1 *= 1000;
 385              		.loc 1 172 0
 386 009a 9FED147A 		vldr.32	s14, .L21+12
 387              	.LVL48:
 388 009e 26EE076A 		vmul.f32	s12, s12, s14
 389              	.LVL49:
 173:Src/control.c ****     t2 *= 1000;
 390              		.loc 1 173 0
 391 00a2 65EE877A 		vmul.f32	s15, s11, s14
 392              	.LVL50:
 174:Src/control.c ****     t3 *= 1000;
 393              		.loc 1 174 0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 11


 394 00a6 66EE876A 		vmul.f32	s13, s13, s14
 395              	.LVL51:
 175:Src/control.c **** 
 176:Src/control.c ****     yawrate_tim.up = t1;
 396              		.loc 1 176 0
 397 00aa 114B     		ldr	r3, .L21+16
 398              	.LVL52:
 399 00ac BCEEC66A 		vcvt.u32.f32	s12, s12
 400              	.LVL53:
 401 00b0 16EE102A 		vmov	r2, s12	@ int
 402 00b4 1A80     		strh	r2, [r3]	@ movhi
 177:Src/control.c ****     yawrate_tim.cons = t2;
 403              		.loc 1 177 0
 404 00b6 FCEEE77A 		vcvt.u32.f32	s15, s15
 405              	.LVL54:
 406 00ba 17EE902A 		vmov	r2, s15	@ int
 407 00be 5A80     		strh	r2, [r3, #2]	@ movhi
 178:Src/control.c ****     yawrate_tim.down = t3;
 408              		.loc 1 178 0
 409 00c0 FCEEE66A 		vcvt.u32.f32	s13, s13
 410              	.LVL55:
 411 00c4 16EE902A 		vmov	r2, s13	@ int
 412 00c8 9A80     		strh	r2, [r3, #4]	@ movhi
 179:Src/control.c **** 
 180:Src/control.c ****     flag_motion_end = FALSE;
 413              		.loc 1 180 0
 414 00ca 0A4B     		ldr	r3, .L21+20
 415 00cc 0022     		movs	r2, #0
 416 00ce 1A70     		strb	r2, [r3]
 181:Src/control.c **** }
 417              		.loc 1 181 0
 418 00d0 70BC     		pop	{r4, r5, r6}
 419              	.LCFI7:
 420              		.cfi_remember_state
 421              		.cfi_restore 6
 422              		.cfi_restore 5
 423              		.cfi_restore 4
 424              		.cfi_def_cfa_offset 0
 425 00d2 7047     		bx	lr
 426              	.LVL56:
 427              	.L20:
 428              	.LCFI8:
 429              		.cfi_restore_state
 156:Src/control.c ****         accel = 1;
 430              		.loc 1 156 0
 431 00d4 044B     		ldr	r3, .L21+8
 432              	.LVL57:
 433 00d6 0024     		movs	r4, #0
 434 00d8 1C71     		strb	r4, [r3, #4]
 435              	.LVL58:
 157:Src/control.c ****         v_max = 1;
 436              		.loc 1 157 0
 437 00da 0124     		movs	r4, #1
 158:Src/control.c ****     }
 438              		.loc 1 158 0
 439 00dc 2346     		mov	r3, r4
 440 00de A8E7     		b	.L16
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 12


 441              	.L22:
 442              		.align	2
 443              	.L21:
 444 00e0 00000000 		.word	enc_before
 445 00e4 00000000 		.word	y_before
 446 00e8 00000000 		.word	yawrate_tgt
 447 00ec 00007A44 		.word	1148846080
 448 00f0 00000000 		.word	yawrate_tim
 449 00f4 00000000 		.word	flag_motion_end
 450              		.cfi_endproc
 451              	.LFE128:
 453              		.global	__aeabi_i2d
 454              		.global	__aeabi_d2iz
 455              		.global	__aeabi_dsub
 456              		.section	.text.Control_encoder,"ax",%progbits
 457              		.align	1
 458              		.global	Control_encoder
 459              		.syntax unified
 460              		.thumb
 461              		.thumb_func
 462              		.fpu fpv4-sp-d16
 464              	Control_encoder:
 465              	.LFB129:
 182:Src/control.c **** 
 183:Src/control.c **** /****************************************************************************************
 184:Src/control.c ****  * outline  : output pwm for trapezoid accele straight by feadbuck control
 185:Src/control.c ****  * argument : void
 186:Src/control.c ****  * return   : void
 187:Src/control.c **** ********************************************************************************************/
 188:Src/control.c **** float Control_encoder(void)
 189:Src/control.c **** {
 466              		.loc 1 189 0
 467              		.cfi_startproc
 468              		@ args = 0, pretend = 0, frame = 0
 469              		@ frame_needed = 0, uses_anonymous_args = 0
 470 0000 2DE97043 		push	{r4, r5, r6, r8, r9, lr}
 471              	.LCFI9:
 472              		.cfi_def_cfa_offset 24
 473              		.cfi_offset 4, -24
 474              		.cfi_offset 5, -20
 475              		.cfi_offset 6, -16
 476              		.cfi_offset 8, -12
 477              		.cfi_offset 9, -8
 478              		.cfi_offset 14, -4
 479              	.LVL59:
 190:Src/control.c ****     float target = 0;
 191:Src/control.c ****     if (straight_tgt.dir == 0)
 480              		.loc 1 191 0
 481 0004 384B     		ldr	r3, .L32+8
 482 0006 93F90440 		ldrsb	r4, [r3, #4]
 483 000a 44B3     		cbz	r4, .L24
 192:Src/control.c ****     {
 193:Src/control.c ****     }
 194:Src/control.c ****     else
 195:Src/control.c ****     {
 196:Src/control.c ****         if (straight_tim.up > 0)
 484              		.loc 1 196 0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 13


 485 000c 374B     		ldr	r3, .L32+12
 486 000e 1D88     		ldrh	r5, [r3]
 487 0010 5DB9     		cbnz	r5, .L29
 197:Src/control.c ****         {
 198:Src/control.c ****             straight_tgt.velocity += straight_tgt.accel * dt;
 199:Src/control.c ****             straight_tim.up--;
 200:Src/control.c ****         }
 201:Src/control.c ****         else if (straight_tim.cons > 0)
 488              		.loc 1 201 0
 489 0012 364B     		ldr	r3, .L32+12
 490 0014 5B88     		ldrh	r3, [r3, #2]
 491 0016 002B     		cmp	r3, #0
 492 0018 42D1     		bne	.L30
 202:Src/control.c ****         {
 203:Src/control.c ****             straight_tim.cons--;
 204:Src/control.c ****         }
 205:Src/control.c ****         else if (straight_tim.down > 0)
 493              		.loc 1 205 0
 494 001a 344B     		ldr	r3, .L32+12
 495 001c 9D88     		ldrh	r5, [r3, #4]
 496 001e 002D     		cmp	r5, #0
 497 0020 42D1     		bne	.L31
 206:Src/control.c ****         {
 207:Src/control.c ****             straight_tgt.velocity -= straight_tgt.accel * dt;
 208:Src/control.c ****             straight_tim.down--;
 209:Src/control.c ****         }
 210:Src/control.c ****         else
 211:Src/control.c ****         {
 212:Src/control.c ****             flag_motion_end = TRUE;
 498              		.loc 1 212 0
 499 0022 334B     		ldr	r3, .L32+16
 500 0024 0122     		movs	r2, #1
 501 0026 1A70     		strb	r2, [r3]
 502 0028 19E0     		b	.L24
 503              	.L29:
 198:Src/control.c ****             straight_tim.up--;
 504              		.loc 1 198 0
 505 002a 2F4E     		ldr	r6, .L32+8
 506 002c B6F90200 		ldrsh	r0, [r6, #2]
 507 0030 FFF7FEFF 		bl	__aeabi_i2d
 508              	.LVL60:
 509 0034 2AA3     		adr	r3, .L32
 510 0036 D3E90023 		ldrd	r2, [r3]
 511 003a FFF7FEFF 		bl	__aeabi_dmul
 512              	.LVL61:
 513 003e 8046     		mov	r8, r0
 514 0040 8946     		mov	r9, r1
 515 0042 B6F90000 		ldrsh	r0, [r6]
 516 0046 FFF7FEFF 		bl	__aeabi_i2d
 517              	.LVL62:
 518 004a 4246     		mov	r2, r8
 519 004c 4B46     		mov	r3, r9
 520 004e FFF7FEFF 		bl	__aeabi_dadd
 521              	.LVL63:
 522 0052 FFF7FEFF 		bl	__aeabi_d2iz
 523              	.LVL64:
 524 0056 3080     		strh	r0, [r6]	@ movhi
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 14


 199:Src/control.c ****         }
 525              		.loc 1 199 0
 526 0058 013D     		subs	r5, r5, #1
 527 005a 244B     		ldr	r3, .L32+12
 528 005c 1D80     		strh	r5, [r3]	@ movhi
 529              	.L24:
 213:Src/control.c ****         }
 214:Src/control.c ****     }
 215:Src/control.c **** 
 216:Src/control.c ****     target = (float)straight_tgt.dir * straight_tgt.velocity + fwall_error_s;
 530              		.loc 1 216 0
 531 005e 07EE904A 		vmov	s15, r4	@ int
 532 0062 B8EEE70A 		vcvt.f32.s32	s0, s15
 533 0066 204B     		ldr	r3, .L32+8
 534 0068 B3F90030 		ldrsh	r3, [r3]
 535 006c 07EE903A 		vmov	s15, r3	@ int
 536 0070 F8EEE77A 		vcvt.f32.s32	s15, s15
 537 0074 67EE807A 		vmul.f32	s15, s15, s0
 538 0078 1E4B     		ldr	r3, .L32+20
 539 007a 93ED000A 		vldr.32	s0, [r3]
 540              	.LVL65:
 217:Src/control.c **** 
 218:Src/control.c ****     return PID_value(target, enc.velocity, &enc_sum, &enc_before, 4.2f, 10.0f, 0);
 541              		.loc 1 218 0
 542 007e 9FED1E2A 		vldr.32	s4, .L32+24
 543 0082 F2EE041A 		vmov.f32	s3, #1.0e+1
 544 0086 9FED1D1A 		vldr.32	s2, .L32+28
 545 008a 1D49     		ldr	r1, .L32+32
 546 008c 1D48     		ldr	r0, .L32+36
 547 008e 1E4B     		ldr	r3, .L32+40
 548 0090 D3ED010A 		vldr.32	s1, [r3, #4]
 549 0094 37EE800A 		vadd.f32	s0, s15, s0
 550              	.LVL66:
 551 0098 FFF7FEFF 		bl	PID_value
 552              	.LVL67:
 219:Src/control.c **** }
 553              		.loc 1 219 0
 554 009c BDE87083 		pop	{r4, r5, r6, r8, r9, pc}
 555              	.LVL68:
 556              	.L30:
 203:Src/control.c ****         }
 557              		.loc 1 203 0
 558 00a0 013B     		subs	r3, r3, #1
 559 00a2 124A     		ldr	r2, .L32+12
 560 00a4 5380     		strh	r3, [r2, #2]	@ movhi
 561 00a6 DAE7     		b	.L24
 562              	.L31:
 207:Src/control.c ****             straight_tim.down--;
 563              		.loc 1 207 0
 564 00a8 0F4E     		ldr	r6, .L32+8
 565 00aa B6F90200 		ldrsh	r0, [r6, #2]
 566 00ae FFF7FEFF 		bl	__aeabi_i2d
 567              	.LVL69:
 568 00b2 0BA3     		adr	r3, .L32
 569 00b4 D3E90023 		ldrd	r2, [r3]
 570 00b8 FFF7FEFF 		bl	__aeabi_dmul
 571              	.LVL70:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 15


 572 00bc 8046     		mov	r8, r0
 573 00be 8946     		mov	r9, r1
 574 00c0 B6F90000 		ldrsh	r0, [r6]
 575 00c4 FFF7FEFF 		bl	__aeabi_i2d
 576              	.LVL71:
 577 00c8 4246     		mov	r2, r8
 578 00ca 4B46     		mov	r3, r9
 579 00cc FFF7FEFF 		bl	__aeabi_dsub
 580              	.LVL72:
 581 00d0 FFF7FEFF 		bl	__aeabi_d2iz
 582              	.LVL73:
 583 00d4 3080     		strh	r0, [r6]	@ movhi
 208:Src/control.c ****         }
 584              		.loc 1 208 0
 585 00d6 013D     		subs	r5, r5, #1
 586 00d8 044B     		ldr	r3, .L32+12
 587 00da 9D80     		strh	r5, [r3, #4]	@ movhi
 588 00dc BFE7     		b	.L24
 589              	.L33:
 590 00de 00BF     		.align	3
 591              	.L32:
 592 00e0 FCA9F1D2 		.word	-755914244
 593 00e4 4D62503F 		.word	1062232653
 594 00e8 00000000 		.word	straight_tgt
 595 00ec 00000000 		.word	straight_tim
 596 00f0 00000000 		.word	flag_motion_end
 597 00f4 00000000 		.word	.LANCHOR0
 598 00f8 00000000 		.word	0
 599 00fc 66668640 		.word	1082549862
 600 0100 00000000 		.word	enc_before
 601 0104 00000000 		.word	enc_sum
 602 0108 00000000 		.word	enc
 603              		.cfi_endproc
 604              	.LFE129:
 606              		.section	.text.Control_Side_Wall,"ax",%progbits
 607              		.align	1
 608              		.global	Control_Side_Wall
 609              		.syntax unified
 610              		.thumb
 611              		.thumb_func
 612              		.fpu fpv4-sp-d16
 614              	Control_Side_Wall:
 615              	.LFB130:
 220:Src/control.c **** 
 221:Src/control.c **** float Control_Side_Wall(void)
 222:Src/control.c **** {
 616              		.loc 1 222 0
 617              		.cfi_startproc
 618              		@ args = 0, pretend = 0, frame = 0
 619              		@ frame_needed = 0, uses_anonymous_args = 0
 620 0000 10B5     		push	{r4, lr}
 621              	.LCFI10:
 622              		.cfi_def_cfa_offset 8
 623              		.cfi_offset 4, -8
 624              		.cfi_offset 14, -4
 625              	.LVL74:
 223:Src/control.c ****     float wall_dif = 0;
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 16


 224:Src/control.c ****     float kp = 0.3f;
 225:Src/control.c **** 
 226:Src/control.c ****     if (sen_l.now > sen_l.threshold + add_l && sen_r.now > sen_r.threshold + add_r)
 626              		.loc 1 226 0
 627 0002 5F4B     		ldr	r3, .L51
 628 0004 B3F90020 		ldrsh	r2, [r3]
 629 0008 B3F90610 		ldrsh	r1, [r3, #6]
 630 000c 5D4B     		ldr	r3, .L51+4
 631 000e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 632 0010 0B44     		add	r3, r3, r1
 633 0012 9A42     		cmp	r2, r3
 634 0014 09DD     		ble	.L35
 635              		.loc 1 226 0 is_stmt 0 discriminator 1
 636 0016 5C49     		ldr	r1, .L51+8
 637 0018 B1F90000 		ldrsh	r0, [r1]
 638 001c B1F90640 		ldrsh	r4, [r1, #6]
 639 0020 5A49     		ldr	r1, .L51+12
 640 0022 0978     		ldrb	r1, [r1]	@ zero_extendqisi2
 641 0024 2144     		add	r1, r1, r4
 642 0026 8842     		cmp	r0, r1
 643 0028 27DC     		bgt	.L48
 644              	.L35:
 227:Src/control.c ****     {
 228:Src/control.c ****         LED_Control(12);
 229:Src/control.c ****         if (sen_l.diff_1ms > -10 && sen_r.diff_1ms > -10)
 230:Src/control.c ****         {
 231:Src/control.c ****             if (sen_l.diff_1ms < 10 && sen_r.diff_1ms < 10)
 232:Src/control.c ****             {
 233:Src/control.c ****                 wall_dif = kp * ((sen_l.now - sen_l.reference) - (sen_r.now - sen_r.reference));
 234:Src/control.c ****                 add_l = 0;
 235:Src/control.c ****                 add_r = 0;
 236:Src/control.c ****             }
 237:Src/control.c ****         }
 238:Src/control.c ****         else
 239:Src/control.c ****         {
 240:Src/control.c ****             add_l = 150;
 241:Src/control.c ****             add_r = 150;
 242:Src/control.c ****         }
 243:Src/control.c ****     }
 244:Src/control.c ****     else if (sen_l.now > sen_l.threshold + add_l)
 645              		.loc 1 244 0 is_stmt 1
 646 002a 9A42     		cmp	r2, r3
 647 002c 5BDC     		bgt	.L49
 245:Src/control.c ****     {
 246:Src/control.c ****         LED_Control(4);
 247:Src/control.c ****         if (sen_l.diff_1ms > -10 && sen_l.diff_1ms < 10)
 248:Src/control.c ****         {
 249:Src/control.c ****             wall_dif = 2 * kp * (sen_l.now - sen_l.reference);
 250:Src/control.c ****             add_l=0;
 251:Src/control.c ****         }
 252:Src/control.c ****         else
 253:Src/control.c ****         {
 254:Src/control.c ****             add_l = 150;
 255:Src/control.c ****         }
 256:Src/control.c ****     }
 257:Src/control.c ****     else if (sen_r.now > sen_r.threshold + add_r)
 648              		.loc 1 257 0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 17


 649 002e 564B     		ldr	r3, .L51+8
 650 0030 B3F90020 		ldrsh	r2, [r3]
 651 0034 B3F90610 		ldrsh	r1, [r3, #6]
 652 0038 544B     		ldr	r3, .L51+12
 653 003a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 654 003c 0B44     		add	r3, r3, r1
 655 003e 9A42     		cmp	r2, r3
 656 0040 79DD     		ble	.L40
 258:Src/control.c ****     {
 259:Src/control.c ****         LED_Control(8);
 657              		.loc 1 259 0
 658 0042 0820     		movs	r0, #8
 659 0044 FFF7FEFF 		bl	LED_Control
 660              	.LVL75:
 260:Src/control.c ****         if (sen_r.diff_1ms > -10 && sen_r.diff_1ms < 10)
 661              		.loc 1 260 0
 662 0048 4F4B     		ldr	r3, .L51+8
 663 004a B3F90A30 		ldrsh	r3, [r3, #10]
 664 004e 0933     		adds	r3, r3, #9
 665 0050 9BB2     		uxth	r3, r3
 666 0052 122B     		cmp	r3, #18
 667 0054 69D8     		bhi	.L41
 261:Src/control.c ****         {
 262:Src/control.c ****             wall_dif = -2 * kp * (sen_r.now - sen_r.reference);
 668              		.loc 1 262 0
 669 0056 4C4A     		ldr	r2, .L51+8
 670 0058 B2F90030 		ldrsh	r3, [r2]
 671 005c B2F90420 		ldrsh	r2, [r2, #4]
 672 0060 9B1A     		subs	r3, r3, r2
 673 0062 00EE103A 		vmov	s0, r3	@ int
 674 0066 B8EEC00A 		vcvt.f32.s32	s0, s0
 675 006a DFED497A 		vldr.32	s15, .L51+16
 676 006e 20EE270A 		vmul.f32	s0, s0, s15
 677              	.LVL76:
 263:Src/control.c ****             add_r = 0;
 678              		.loc 1 263 0
 679 0072 464B     		ldr	r3, .L51+12
 680 0074 0022     		movs	r2, #0
 681 0076 1A70     		strb	r2, [r3]
 682 0078 62E0     		b	.L37
 683              	.LVL77:
 684              	.L48:
 228:Src/control.c ****         if (sen_l.diff_1ms > -10 && sen_r.diff_1ms > -10)
 685              		.loc 1 228 0
 686 007a 0C20     		movs	r0, #12
 687 007c FFF7FEFF 		bl	LED_Control
 688              	.LVL78:
 229:Src/control.c ****         {
 689              		.loc 1 229 0
 690 0080 3F4B     		ldr	r3, .L51
 691 0082 B3F90A30 		ldrsh	r3, [r3, #10]
 692 0086 13F1090F 		cmn	r3, #9
 693 008a 24DB     		blt	.L36
 229:Src/control.c ****         {
 694              		.loc 1 229 0 is_stmt 0 discriminator 1
 695 008c 3E4A     		ldr	r2, .L51+8
 696 008e B2F90A20 		ldrsh	r2, [r2, #10]
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 18


 697 0092 12F1090F 		cmn	r2, #9
 698 0096 1EDB     		blt	.L36
 231:Src/control.c ****             {
 699              		.loc 1 231 0 is_stmt 1
 700 0098 092B     		cmp	r3, #9
 701 009a 65DC     		bgt	.L45
 231:Src/control.c ****             {
 702              		.loc 1 231 0 is_stmt 0 discriminator 1
 703 009c 092A     		cmp	r2, #9
 704 009e 66DC     		bgt	.L46
 233:Src/control.c ****                 add_l = 0;
 705              		.loc 1 233 0 is_stmt 1
 706 00a0 374A     		ldr	r2, .L51
 707 00a2 B2F90030 		ldrsh	r3, [r2]
 708 00a6 B2F90420 		ldrsh	r2, [r2, #4]
 709 00aa 9B1A     		subs	r3, r3, r2
 710 00ac 3649     		ldr	r1, .L51+8
 711 00ae B1F90020 		ldrsh	r2, [r1]
 712 00b2 B1F90410 		ldrsh	r1, [r1, #4]
 713 00b6 521A     		subs	r2, r2, r1
 714 00b8 9B1A     		subs	r3, r3, r2
 715 00ba 00EE103A 		vmov	s0, r3	@ int
 716 00be B8EEC00A 		vcvt.f32.s32	s0, s0
 717 00c2 DFED347A 		vldr.32	s15, .L51+20
 718 00c6 20EE270A 		vmul.f32	s0, s0, s15
 719              	.LVL79:
 234:Src/control.c ****                 add_r = 0;
 720              		.loc 1 234 0
 721 00ca 0023     		movs	r3, #0
 722 00cc 2D4A     		ldr	r2, .L51+4
 723 00ce 1370     		strb	r3, [r2]
 235:Src/control.c ****             }
 724              		.loc 1 235 0
 725 00d0 2E4A     		ldr	r2, .L51+12
 726 00d2 1370     		strb	r3, [r2]
 727 00d4 34E0     		b	.L37
 728              	.LVL80:
 729              	.L36:
 240:Src/control.c ****             add_r = 150;
 730              		.loc 1 240 0
 731 00d6 9623     		movs	r3, #150
 732 00d8 2A4A     		ldr	r2, .L51+4
 733 00da 1370     		strb	r3, [r2]
 241:Src/control.c ****         }
 734              		.loc 1 241 0
 735 00dc 2B4A     		ldr	r2, .L51+12
 736 00de 1370     		strb	r3, [r2]
 223:Src/control.c ****     float kp = 0.3f;
 737              		.loc 1 223 0
 738 00e0 9FED2D0A 		vldr.32	s0, .L51+24
 739 00e4 2CE0     		b	.L37
 740              	.L49:
 246:Src/control.c ****         if (sen_l.diff_1ms > -10 && sen_l.diff_1ms < 10)
 741              		.loc 1 246 0
 742 00e6 0420     		movs	r0, #4
 743 00e8 FFF7FEFF 		bl	LED_Control
 744              	.LVL81:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 19


 247:Src/control.c ****         {
 745              		.loc 1 247 0
 746 00ec 244B     		ldr	r3, .L51
 747 00ee B3F90A30 		ldrsh	r3, [r3, #10]
 748 00f2 0933     		adds	r3, r3, #9
 749 00f4 9BB2     		uxth	r3, r3
 750 00f6 122B     		cmp	r3, #18
 751 00f8 11D8     		bhi	.L39
 249:Src/control.c ****             add_l=0;
 752              		.loc 1 249 0
 753 00fa 214A     		ldr	r2, .L51
 754 00fc B2F90030 		ldrsh	r3, [r2]
 755 0100 B2F90420 		ldrsh	r2, [r2, #4]
 756 0104 9B1A     		subs	r3, r3, r2
 757 0106 00EE103A 		vmov	s0, r3	@ int
 758 010a B8EEC00A 		vcvt.f32.s32	s0, s0
 759 010e DFED237A 		vldr.32	s15, .L51+28
 760 0112 20EE270A 		vmul.f32	s0, s0, s15
 761              	.LVL82:
 250:Src/control.c ****         }
 762              		.loc 1 250 0
 763 0116 1B4B     		ldr	r3, .L51+4
 764 0118 0022     		movs	r2, #0
 765 011a 1A70     		strb	r2, [r3]
 766 011c 10E0     		b	.L37
 767              	.LVL83:
 768              	.L39:
 254:Src/control.c ****         }
 769              		.loc 1 254 0
 770 011e 194B     		ldr	r3, .L51+4
 771 0120 9622     		movs	r2, #150
 772 0122 1A70     		strb	r2, [r3]
 223:Src/control.c ****     float kp = 0.3f;
 773              		.loc 1 223 0
 774 0124 9FED1C0A 		vldr.32	s0, .L51+24
 775 0128 0AE0     		b	.L37
 776              	.L41:
 264:Src/control.c ****         }
 265:Src/control.c ****         else
 266:Src/control.c ****         {
 267:Src/control.c ****             add_r = 150;
 777              		.loc 1 267 0
 778 012a 184B     		ldr	r3, .L51+12
 779 012c 9622     		movs	r2, #150
 780 012e 1A70     		strb	r2, [r3]
 223:Src/control.c ****     float kp = 0.3f;
 781              		.loc 1 223 0
 782 0130 9FED190A 		vldr.32	s0, .L51+24
 783 0134 04E0     		b	.L37
 784              	.L40:
 268:Src/control.c ****         }
 269:Src/control.c ****     }
 270:Src/control.c ****     else
 271:Src/control.c ****     {
 272:Src/control.c ****         LED_Control(0);
 785              		.loc 1 272 0
 786 0136 0020     		movs	r0, #0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 20


 787 0138 FFF7FEFF 		bl	LED_Control
 788              	.LVL84:
 223:Src/control.c ****     float kp = 0.3f;
 789              		.loc 1 223 0
 790 013c 9FED160A 		vldr.32	s0, .L51+24
 791              	.LVL85:
 792              	.L37:
 273:Src/control.c ****     }
 274:Src/control.c **** 
 275:Src/control.c ****     if (flag_wall != TRUE)
 793              		.loc 1 275 0
 794 0140 174B     		ldr	r3, .L51+32
 795 0142 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 796 0144 012B     		cmp	r3, #1
 797 0146 15D1     		bne	.L50
 798              	.LVL86:
 799              	.L42:
 276:Src/control.c ****     {
 277:Src/control.c ****         wall_dif = 0;
 278:Src/control.c ****         LED_Control(0);
 279:Src/control.c ****     }
 280:Src/control.c **** 
 281:Src/control.c ****     if (yawrate_tgt.dir != 0 || straight_tgt.velocity < 400)
 800              		.loc 1 281 0
 801 0148 164B     		ldr	r3, .L51+36
 802 014a 93F90430 		ldrsb	r3, [r3, #4]
 803 014e 2BB9     		cbnz	r3, .L43
 804              		.loc 1 281 0 is_stmt 0 discriminator 1
 805 0150 154B     		ldr	r3, .L51+40
 806 0152 B3F90030 		ldrsh	r3, [r3]
 807 0156 B3F5C87F 		cmp	r3, #400
 808 015a 04DA     		bge	.L34
 809              	.L43:
 810              	.LVL87:
 282:Src/control.c ****     {
 283:Src/control.c ****         wall_dif = 0;
 284:Src/control.c ****         LED_Control(0);
 811              		.loc 1 284 0 is_stmt 1
 812 015c 0020     		movs	r0, #0
 813 015e FFF7FEFF 		bl	LED_Control
 814              	.LVL88:
 283:Src/control.c ****         LED_Control(0);
 815              		.loc 1 283 0
 816 0162 9FED0D0A 		vldr.32	s0, .L51+24
 817              	.LVL89:
 818              	.L34:
 285:Src/control.c ****     }
 286:Src/control.c ****     return wall_dif;
 287:Src/control.c **** }
 819              		.loc 1 287 0
 820 0166 10BD     		pop	{r4, pc}
 821              	.LVL90:
 822              	.L45:
 223:Src/control.c ****     float kp = 0.3f;
 823              		.loc 1 223 0
 824 0168 9FED0B0A 		vldr.32	s0, .L51+24
 825 016c E8E7     		b	.L37
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 21


 826              	.L46:
 827 016e 9FED0A0A 		vldr.32	s0, .L51+24
 828 0172 E5E7     		b	.L37
 829              	.LVL91:
 830              	.L50:
 278:Src/control.c ****     }
 831              		.loc 1 278 0
 832 0174 0020     		movs	r0, #0
 833 0176 FFF7FEFF 		bl	LED_Control
 834              	.LVL92:
 277:Src/control.c ****         LED_Control(0);
 835              		.loc 1 277 0
 836 017a 9FED070A 		vldr.32	s0, .L51+24
 837 017e E3E7     		b	.L42
 838              	.L52:
 839              		.align	2
 840              	.L51:
 841 0180 00000000 		.word	sen_l
 842 0184 00000000 		.word	.LANCHOR1
 843 0188 00000000 		.word	sen_r
 844 018c 00000000 		.word	.LANCHOR2
 845 0190 9A9919BF 		.word	-1088841318
 846 0194 9A99993E 		.word	1050253722
 847 0198 00000000 		.word	0
 848 019c 9A99193F 		.word	1058642330
 849 01a0 00000000 		.word	flag_wall
 850 01a4 00000000 		.word	yawrate_tgt
 851 01a8 00000000 		.word	straight_tgt
 852              		.cfi_endproc
 853              	.LFE130:
 855              		.section	.text.Control_gyro,"ax",%progbits
 856              		.align	1
 857              		.global	Control_gyro
 858              		.syntax unified
 859              		.thumb
 860              		.thumb_func
 861              		.fpu fpv4-sp-d16
 863              	Control_gyro:
 864              	.LFB131:
 288:Src/control.c **** 
 289:Src/control.c **** /****************************************************************************************
 290:Src/control.c ****  * outline  : call 1ms (control yawrate by feadbuck)
 291:Src/control.c ****  * argument : void
 292:Src/control.c ****  * return   : void
 293:Src/control.c **** ********************************************************************************************/
 294:Src/control.c **** float Control_gyro(void)
 295:Src/control.c **** {
 865              		.loc 1 295 0
 866              		.cfi_startproc
 867              		@ args = 0, pretend = 0, frame = 0
 868              		@ frame_needed = 0, uses_anonymous_args = 0
 869 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 870              	.LCFI11:
 871              		.cfi_def_cfa_offset 24
 872              		.cfi_offset 3, -24
 873              		.cfi_offset 4, -20
 874              		.cfi_offset 5, -16
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 22


 875              		.cfi_offset 6, -12
 876              		.cfi_offset 7, -8
 877              		.cfi_offset 14, -4
 878 0002 2DED028B 		vpush.64	{d8}
 879              	.LCFI12:
 880              		.cfi_def_cfa_offset 32
 881              		.cfi_offset 80, -32
 882              		.cfi_offset 81, -28
 883              	.LVL93:
 296:Src/control.c ****     float target = 0;
 297:Src/control.c **** 
 298:Src/control.c ****     if (yawrate_tgt.dir == 0)
 884              		.loc 1 298 0
 885 0006 404B     		ldr	r3, .L64+8
 886 0008 93F90430 		ldrsb	r3, [r3, #4]
 887 000c 93B1     		cbz	r3, .L60
 299:Src/control.c ****     {
 300:Src/control.c ****         yawrate_tgt.velocity = 0;
 301:Src/control.c ****     }
 302:Src/control.c ****     else if (yawrate_tim.up > 0)
 888              		.loc 1 302 0
 889 000e 3F4B     		ldr	r3, .L64+12
 890 0010 1C88     		ldrh	r4, [r3]
 891 0012 002C     		cmp	r4, #0
 892 0014 39D1     		bne	.L61
 303:Src/control.c ****     {
 304:Src/control.c ****         yawrate_tgt.velocity += yawrate_tgt.accel * dt;
 305:Src/control.c ****         yawrate_tim.up--;
 306:Src/control.c ****     }
 307:Src/control.c ****     else if (yawrate_tim.cons > 0)
 893              		.loc 1 307 0
 894 0016 3D4B     		ldr	r3, .L64+12
 895 0018 5B88     		ldrh	r3, [r3, #2]
 896 001a 002B     		cmp	r3, #0
 897 001c 50D1     		bne	.L62
 308:Src/control.c ****     {
 309:Src/control.c ****         yawrate_tim.cons--;
 310:Src/control.c ****     }
 311:Src/control.c ****     else if (yawrate_tim.down > 0)
 898              		.loc 1 311 0
 899 001e 3B4B     		ldr	r3, .L64+12
 900 0020 9C88     		ldrh	r4, [r3, #4]
 901 0022 002C     		cmp	r4, #0
 902 0024 50D1     		bne	.L63
 312:Src/control.c ****     {
 313:Src/control.c ****         yawrate_tgt.velocity -= yawrate_tgt.accel * dt;
 314:Src/control.c ****         yawrate_tim.down--;
 315:Src/control.c ****     }
 316:Src/control.c ****     else
 317:Src/control.c ****     {
 318:Src/control.c ****         yawrate_tgt.velocity = 0;
 903              		.loc 1 318 0
 904 0026 384B     		ldr	r3, .L64+8
 905 0028 0022     		movs	r2, #0
 906 002a 1A80     		strh	r2, [r3]	@ movhi
 319:Src/control.c ****         flag_motion_end = TRUE;
 907              		.loc 1 319 0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 23


 908 002c 384B     		ldr	r3, .L64+16
 909 002e 0122     		movs	r2, #1
 910 0030 1A70     		strb	r2, [r3]
 911 0032 02E0     		b	.L55
 912              	.L60:
 300:Src/control.c ****     }
 913              		.loc 1 300 0
 914 0034 344B     		ldr	r3, .L64+8
 915 0036 0022     		movs	r2, #0
 916 0038 1A80     		strh	r2, [r3]	@ movhi
 917              	.L55:
 320:Src/control.c ****     }
 321:Src/control.c **** 
 322:Src/control.c ****     target = (float)yawrate_tgt.dir * yawrate_tgt.velocity - Control_Side_Wall() + fwall_error_y;
 918              		.loc 1 322 0
 919 003a 334B     		ldr	r3, .L64+8
 920 003c 93F90420 		ldrsb	r2, [r3, #4]
 921 0040 08EE102A 		vmov	s16, r2	@ int
 922 0044 B8EEC80A 		vcvt.f32.s32	s0, s16
 923 0048 B3F90030 		ldrsh	r3, [r3]
 924 004c 08EE103A 		vmov	s16, r3	@ int
 925 0050 B8EEC88A 		vcvt.f32.s32	s16, s16
 926 0054 28EE008A 		vmul.f32	s16, s16, s0
 927 0058 FFF7FEFF 		bl	Control_Side_Wall
 928              	.LVL94:
 929 005c 38EE400A 		vsub.f32	s0, s16, s0
 930 0060 2C4B     		ldr	r3, .L64+20
 931 0062 D3ED007A 		vldr.32	s15, [r3]
 932              	.LVL95:
 323:Src/control.c **** 
 324:Src/control.c ****     return PID_value(target, gyro.velocity, &y_sum, &y_before, 0.98f, 18.0f, 4.5f); //2.0f, 20.0f, 
 933              		.loc 1 324 0
 934 0066 B1EE022A 		vmov.f32	s4, #4.5e+0
 935 006a F3EE021A 		vmov.f32	s3, #1.8e+1
 936 006e 9FED2A1A 		vldr.32	s2, .L64+24
 937 0072 2A49     		ldr	r1, .L64+28
 938 0074 2A48     		ldr	r0, .L64+32
 939 0076 2B4B     		ldr	r3, .L64+36
 940 0078 D3ED000A 		vldr.32	s1, [r3]
 941 007c 30EE270A 		vadd.f32	s0, s0, s15
 942              	.LVL96:
 943 0080 FFF7FEFF 		bl	PID_value
 944              	.LVL97:
 325:Src/control.c **** }
 945              		.loc 1 325 0
 946 0084 BDEC028B 		vldm	sp!, {d8}
 947              	.LCFI13:
 948              		.cfi_remember_state
 949              		.cfi_restore 80
 950              		.cfi_restore 81
 951              		.cfi_def_cfa_offset 24
 952 0088 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 953              	.LVL98:
 954              	.L61:
 955              	.LCFI14:
 956              		.cfi_restore_state
 304:Src/control.c ****         yawrate_tim.up--;
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 24


 957              		.loc 1 304 0
 958 008a 1F4D     		ldr	r5, .L64+8
 959 008c B5F90200 		ldrsh	r0, [r5, #2]
 960 0090 FFF7FEFF 		bl	__aeabi_i2d
 961              	.LVL99:
 962 0094 1AA3     		adr	r3, .L64
 963 0096 D3E90023 		ldrd	r2, [r3]
 964 009a FFF7FEFF 		bl	__aeabi_dmul
 965              	.LVL100:
 966 009e 0646     		mov	r6, r0
 967 00a0 0F46     		mov	r7, r1
 968 00a2 B5F90000 		ldrsh	r0, [r5]
 969 00a6 FFF7FEFF 		bl	__aeabi_i2d
 970              	.LVL101:
 971 00aa 3246     		mov	r2, r6
 972 00ac 3B46     		mov	r3, r7
 973 00ae FFF7FEFF 		bl	__aeabi_dadd
 974              	.LVL102:
 975 00b2 FFF7FEFF 		bl	__aeabi_d2iz
 976              	.LVL103:
 977 00b6 2880     		strh	r0, [r5]	@ movhi
 305:Src/control.c ****     }
 978              		.loc 1 305 0
 979 00b8 013C     		subs	r4, r4, #1
 980 00ba 144B     		ldr	r3, .L64+12
 981 00bc 1C80     		strh	r4, [r3]	@ movhi
 982 00be BCE7     		b	.L55
 983              	.L62:
 309:Src/control.c ****     }
 984              		.loc 1 309 0
 985 00c0 013B     		subs	r3, r3, #1
 986 00c2 124A     		ldr	r2, .L64+12
 987 00c4 5380     		strh	r3, [r2, #2]	@ movhi
 988 00c6 B8E7     		b	.L55
 989              	.L63:
 313:Src/control.c ****         yawrate_tim.down--;
 990              		.loc 1 313 0
 991 00c8 0F4D     		ldr	r5, .L64+8
 992 00ca B5F90200 		ldrsh	r0, [r5, #2]
 993 00ce FFF7FEFF 		bl	__aeabi_i2d
 994              	.LVL104:
 995 00d2 0BA3     		adr	r3, .L64
 996 00d4 D3E90023 		ldrd	r2, [r3]
 997 00d8 FFF7FEFF 		bl	__aeabi_dmul
 998              	.LVL105:
 999 00dc 0646     		mov	r6, r0
 1000 00de 0F46     		mov	r7, r1
 1001 00e0 B5F90000 		ldrsh	r0, [r5]
 1002 00e4 FFF7FEFF 		bl	__aeabi_i2d
 1003              	.LVL106:
 1004 00e8 3246     		mov	r2, r6
 1005 00ea 3B46     		mov	r3, r7
 1006 00ec FFF7FEFF 		bl	__aeabi_dsub
 1007              	.LVL107:
 1008 00f0 FFF7FEFF 		bl	__aeabi_d2iz
 1009              	.LVL108:
 1010 00f4 2880     		strh	r0, [r5]	@ movhi
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 25


 314:Src/control.c ****     }
 1011              		.loc 1 314 0
 1012 00f6 013C     		subs	r4, r4, #1
 1013 00f8 044B     		ldr	r3, .L64+12
 1014 00fa 9C80     		strh	r4, [r3, #4]	@ movhi
 1015 00fc 9DE7     		b	.L55
 1016              	.L65:
 1017 00fe 00BF     		.align	3
 1018              	.L64:
 1019 0100 FCA9F1D2 		.word	-755914244
 1020 0104 4D62503F 		.word	1062232653
 1021 0108 00000000 		.word	yawrate_tgt
 1022 010c 00000000 		.word	yawrate_tim
 1023 0110 00000000 		.word	flag_motion_end
 1024 0114 00000000 		.word	.LANCHOR3
 1025 0118 48E17A3F 		.word	1065017672
 1026 011c 00000000 		.word	y_before
 1027 0120 00000000 		.word	y_sum
 1028 0124 00000000 		.word	gyro
 1029              		.cfi_endproc
 1030              	.LFE131:
 1032              		.section	.text.Control_Front_Wall,"ax",%progbits
 1033              		.align	1
 1034              		.global	Control_Front_Wall
 1035              		.syntax unified
 1036              		.thumb
 1037              		.thumb_func
 1038              		.fpu fpv4-sp-d16
 1040              	Control_Front_Wall:
 1041              	.LFB132:
 326:Src/control.c **** 
 327:Src/control.c **** void Control_Front_Wall(void)
 328:Src/control.c **** {
 1042              		.loc 1 328 0
 1043              		.cfi_startproc
 1044              		@ args = 0, pretend = 0, frame = 0
 1045              		@ frame_needed = 0, uses_anonymous_args = 0
 1046              		@ link register save eliminated.
 1047              	.LVL109:
 329:Src/control.c ****     float error_s = 0;
 330:Src/control.c ****     float error_y = 0;
 331:Src/control.c **** 
 332:Src/control.c ****     if (straight_tgt.velocity == 0 && yawrate_tgt.velocity == 0)
 1048              		.loc 1 332 0
 1049 0000 334B     		ldr	r3, .L78
 1050 0002 B3F90030 		ldrsh	r3, [r3]
 1051 0006 3BB9     		cbnz	r3, .L67
 1052              		.loc 1 332 0 is_stmt 0 discriminator 1
 1053 0008 324B     		ldr	r3, .L78+4
 1054 000a B3F90030 		ldrsh	r3, [r3]
 1055 000e 1BB9     		cbnz	r3, .L67
 333:Src/control.c ****     {
 334:Src/control.c ****         if (sen_front.is_wall == TRUE)
 1056              		.loc 1 334 0 is_stmt 1
 1057 0010 314B     		ldr	r3, .L78+8
 1058 0012 1B7B     		ldrb	r3, [r3, #12]	@ zero_extendqisi2
 1059 0014 012B     		cmp	r3, #1
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 26


 1060 0016 08D0     		beq	.L77
 1061              	.LVL110:
 1062              	.L67:
 335:Src/control.c ****         {
 336:Src/control.c ****             error_s = sen_front.reference - sen_front.now;
 337:Src/control.c ****             error_y = sen_fl.now - sen_fl.reference - (sen_fr.now - sen_fr.reference);
 338:Src/control.c ****             fwall_error_s = error_s * 2.0f;
 339:Src/control.c ****             fwall_error_y = error_y * 3.0f;
 340:Src/control.c ****             if (-3 < error_s && error_s < 3)
 341:Src/control.c ****             {
 342:Src/control.c ****                 if (-3 < error_y && error_y < 3)
 343:Src/control.c ****                 {
 344:Src/control.c ****                     fwall_error_s = 0;
 345:Src/control.c ****                     fwall_error_y = 0;
 346:Src/control.c ****                     enc_sum = 0;
 347:Src/control.c ****                     enc_before = 0;
 348:Src/control.c ****                     y_sum = 0;
 349:Src/control.c ****                     y_before = 0;
 350:Src/control.c ****                     flag_front_wall = FALSE;
 351:Src/control.c ****                 }
 352:Src/control.c ****             }
 353:Src/control.c ****         }
 354:Src/control.c ****     }
 355:Src/control.c ****     if (flag_front_wall == FALSE)
 1063              		.loc 1 355 0
 1064 0018 304B     		ldr	r3, .L78+12
 1065 001a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1066 001c 23B9     		cbnz	r3, .L66
 356:Src/control.c ****     {
 357:Src/control.c ****         fwall_error_s = 0;
 1067              		.loc 1 357 0
 1068 001e 0023     		movs	r3, #0
 1069 0020 2F4A     		ldr	r2, .L78+16
 1070 0022 1360     		str	r3, [r2]	@ float
 358:Src/control.c ****         fwall_error_y = 0;
 1071              		.loc 1 358 0
 1072 0024 2F4A     		ldr	r2, .L78+20
 1073 0026 1360     		str	r3, [r2]	@ float
 1074              	.L66:
 359:Src/control.c ****     }
 360:Src/control.c **** }
 1075              		.loc 1 360 0
 1076 0028 7047     		bx	lr
 1077              	.LVL111:
 1078              	.L77:
 336:Src/control.c ****             error_y = sen_fl.now - sen_fl.reference - (sen_fr.now - sen_fr.reference);
 1079              		.loc 1 336 0
 1080 002a 2B4A     		ldr	r2, .L78+8
 1081 002c B2F90430 		ldrsh	r3, [r2, #4]
 1082 0030 B2F90020 		ldrsh	r2, [r2]
 1083 0034 9B1A     		subs	r3, r3, r2
 1084 0036 07EE903A 		vmov	s15, r3	@ int
 1085 003a F8EEE77A 		vcvt.f32.s32	s15, s15
 1086              	.LVL112:
 337:Src/control.c ****             fwall_error_s = error_s * 2.0f;
 1087              		.loc 1 337 0
 1088 003e 2A4A     		ldr	r2, .L78+24
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 27


 1089 0040 B2F90030 		ldrsh	r3, [r2]
 1090 0044 B2F90420 		ldrsh	r2, [r2, #4]
 1091 0048 9B1A     		subs	r3, r3, r2
 1092 004a 2849     		ldr	r1, .L78+28
 1093 004c B1F90020 		ldrsh	r2, [r1]
 1094 0050 B1F90410 		ldrsh	r1, [r1, #4]
 1095 0054 521A     		subs	r2, r2, r1
 1096 0056 9B1A     		subs	r3, r3, r2
 1097 0058 07EE103A 		vmov	s14, r3	@ int
 1098 005c B8EEC77A 		vcvt.f32.s32	s14, s14
 1099              	.LVL113:
 338:Src/control.c ****             fwall_error_y = error_y * 3.0f;
 1100              		.loc 1 338 0
 1101 0060 77EEA76A 		vadd.f32	s13, s15, s15
 1102 0064 1E4B     		ldr	r3, .L78+16
 1103 0066 C3ED006A 		vstr.32	s13, [r3]
 339:Src/control.c ****             if (-3 < error_s && error_s < 3)
 1104              		.loc 1 339 0
 1105 006a F0EE086A 		vmov.f32	s13, #3.0e+0
 1106 006e 67EE266A 		vmul.f32	s13, s14, s13
 1107 0072 1C4B     		ldr	r3, .L78+20
 1108 0074 C3ED006A 		vstr.32	s13, [r3]
 340:Src/control.c ****             {
 1109              		.loc 1 340 0
 1110 0078 F8EE086A 		vmov.f32	s13, #-3.0e+0
 1111 007c F4EEE67A 		vcmpe.f32	s15, s13
 1112 0080 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1113 0084 C8DD     		ble	.L67
 340:Src/control.c ****             {
 1114              		.loc 1 340 0 is_stmt 0 discriminator 1
 1115 0086 F0EE086A 		vmov.f32	s13, #3.0e+0
 1116 008a F4EEE67A 		vcmpe.f32	s15, s13
 1117 008e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1118 0092 C1D5     		bpl	.L67
 342:Src/control.c ****                 {
 1119              		.loc 1 342 0 is_stmt 1
 1120 0094 F8EE087A 		vmov.f32	s15, #-3.0e+0
 1121              	.LVL114:
 1122 0098 B4EEE77A 		vcmpe.f32	s14, s15
 1123 009c F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1124 00a0 BADD     		ble	.L67
 342:Src/control.c ****                 {
 1125              		.loc 1 342 0 is_stmt 0 discriminator 1
 1126 00a2 B4EEE67A 		vcmpe.f32	s14, s13
 1127 00a6 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1128 00aa B5D5     		bpl	.L67
 344:Src/control.c ****                     fwall_error_y = 0;
 1129              		.loc 1 344 0 is_stmt 1
 1130 00ac 0023     		movs	r3, #0
 1131 00ae 0C4A     		ldr	r2, .L78+16
 1132 00b0 1360     		str	r3, [r2]	@ float
 345:Src/control.c ****                     enc_sum = 0;
 1133              		.loc 1 345 0
 1134 00b2 0C4A     		ldr	r2, .L78+20
 1135 00b4 1360     		str	r3, [r2]	@ float
 346:Src/control.c ****                     enc_before = 0;
 1136              		.loc 1 346 0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 28


 1137 00b6 0E4A     		ldr	r2, .L78+32
 1138 00b8 1360     		str	r3, [r2]	@ float
 347:Src/control.c ****                     y_sum = 0;
 1139              		.loc 1 347 0
 1140 00ba 0E4A     		ldr	r2, .L78+36
 1141 00bc 1360     		str	r3, [r2]	@ float
 348:Src/control.c ****                     y_before = 0;
 1142              		.loc 1 348 0
 1143 00be 0E4A     		ldr	r2, .L78+40
 1144 00c0 1360     		str	r3, [r2]	@ float
 349:Src/control.c ****                     flag_front_wall = FALSE;
 1145              		.loc 1 349 0
 1146 00c2 0E4A     		ldr	r2, .L78+44
 1147 00c4 1360     		str	r3, [r2]	@ float
 350:Src/control.c ****                 }
 1148              		.loc 1 350 0
 1149 00c6 054B     		ldr	r3, .L78+12
 1150 00c8 0022     		movs	r2, #0
 1151 00ca 1A70     		strb	r2, [r3]
 1152 00cc A4E7     		b	.L67
 1153              	.L79:
 1154 00ce 00BF     		.align	2
 1155              	.L78:
 1156 00d0 00000000 		.word	straight_tgt
 1157 00d4 00000000 		.word	yawrate_tgt
 1158 00d8 00000000 		.word	sen_front
 1159 00dc 00000000 		.word	flag_front_wall
 1160 00e0 00000000 		.word	.LANCHOR0
 1161 00e4 00000000 		.word	.LANCHOR3
 1162 00e8 00000000 		.word	sen_fl
 1163 00ec 00000000 		.word	sen_fr
 1164 00f0 00000000 		.word	enc_sum
 1165 00f4 00000000 		.word	enc_before
 1166 00f8 00000000 		.word	y_sum
 1167 00fc 00000000 		.word	y_before
 1168              		.cfi_endproc
 1169              	.LFE132:
 1171              		.section	.text.Control_pwm,"ax",%progbits
 1172              		.align	1
 1173              		.global	Control_pwm
 1174              		.syntax unified
 1175              		.thumb
 1176              		.thumb_func
 1177              		.fpu fpv4-sp-d16
 1179              	Control_pwm:
 1180              	.LFB133:
 361:Src/control.c **** 
 362:Src/control.c **** void Control_pwm(void)
 363:Src/control.c **** {
 1181              		.loc 1 363 0
 1182              		.cfi_startproc
 1183              		@ args = 0, pretend = 0, frame = 0
 1184              		@ frame_needed = 0, uses_anonymous_args = 0
 1185 0000 10B5     		push	{r4, lr}
 1186              	.LCFI15:
 1187              		.cfi_def_cfa_offset 8
 1188              		.cfi_offset 4, -8
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 29


 1189              		.cfi_offset 14, -4
 364:Src/control.c ****     if (flag_motor == TRUE)
 1190              		.loc 1 364 0
 1191 0002 104B     		ldr	r3, .L85
 1192 0004 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1193 0006 012B     		cmp	r3, #1
 1194 0008 04D0     		beq	.L84
 365:Src/control.c ****     {
 366:Src/control.c ****         int16_t straight_pid = 0;
 367:Src/control.c ****         int16_t yawrate_pid = 0;
 368:Src/control.c **** 
 369:Src/control.c ****         Control_Front_Wall();
 370:Src/control.c ****         straight_pid = (int16_t)Control_encoder();
 371:Src/control.c ****         yawrate_pid = (int16_t)Control_gyro();
 372:Src/control.c **** 
 373:Src/control.c ****         Motor_pwm(straight_pid - yawrate_pid, straight_pid + yawrate_pid);
 374:Src/control.c ****     }
 375:Src/control.c ****     else
 376:Src/control.c ****     {
 377:Src/control.c ****         Motor_pwm(0, 0);
 1195              		.loc 1 377 0
 1196 000a 0021     		movs	r1, #0
 1197 000c 0846     		mov	r0, r1
 1198 000e FFF7FEFF 		bl	Motor_pwm
 1199              	.LVL115:
 1200              	.L80:
 378:Src/control.c ****     }
 379:Src/control.c **** }
 1201              		.loc 1 379 0
 1202 0012 10BD     		pop	{r4, pc}
 1203              	.L84:
 1204              	.LVL116:
 1205              	.LBB2:
 369:Src/control.c ****         straight_pid = (int16_t)Control_encoder();
 1206              		.loc 1 369 0
 1207 0014 FFF7FEFF 		bl	Control_Front_Wall
 1208              	.LVL117:
 370:Src/control.c ****         yawrate_pid = (int16_t)Control_gyro();
 1209              		.loc 1 370 0
 1210 0018 FFF7FEFF 		bl	Control_encoder
 1211              	.LVL118:
 1212 001c BDEEC00A 		vcvt.s32.f32	s0, s0
 1213 0020 10EE103A 		vmov	r3, s0	@ int
 1214 0024 1CB2     		sxth	r4, r3
 1215              	.LVL119:
 371:Src/control.c **** 
 1216              		.loc 1 371 0
 1217 0026 FFF7FEFF 		bl	Control_gyro
 1218              	.LVL120:
 1219 002a BDEEC00A 		vcvt.s32.f32	s0, s0
 1220              	.LVL121:
 373:Src/control.c ****     }
 1221              		.loc 1 373 0
 1222 002e A1B2     		uxth	r1, r4
 1223 0030 10EE103A 		vmov	r3, s0	@ int
 1224 0034 9BB2     		uxth	r3, r3
 1225 0036 C81A     		subs	r0, r1, r3
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 30


 1226 0038 1944     		add	r1, r1, r3
 1227 003a 09B2     		sxth	r1, r1
 1228 003c 00B2     		sxth	r0, r0
 1229 003e FFF7FEFF 		bl	Motor_pwm
 1230              	.LVL122:
 1231              	.LBE2:
 1232 0042 E6E7     		b	.L80
 1233              	.L86:
 1234              		.align	2
 1235              	.L85:
 1236 0044 00000000 		.word	flag_motor
 1237              		.cfi_endproc
 1238              	.LFE133:
 1240              		.section	.text.Control_EmergencyStop,"ax",%progbits
 1241              		.align	1
 1242              		.global	Control_EmergencyStop
 1243              		.syntax unified
 1244              		.thumb
 1245              		.thumb_func
 1246              		.fpu fpv4-sp-d16
 1248              	Control_EmergencyStop:
 1249              	.LFB134:
 380:Src/control.c **** 
 381:Src/control.c **** void Control_EmergencyStop(unsigned short diff_yaw)
 382:Src/control.c **** {
 1250              		.loc 1 382 0
 1251              		.cfi_startproc
 1252              		@ args = 0, pretend = 0, frame = 0
 1253              		@ frame_needed = 0, uses_anonymous_args = 0
 1254              	.LVL123:
 1255 0000 38B5     		push	{r3, r4, r5, lr}
 1256              	.LCFI16:
 1257              		.cfi_def_cfa_offset 16
 1258              		.cfi_offset 3, -16
 1259              		.cfi_offset 4, -12
 1260              		.cfi_offset 5, -8
 1261              		.cfi_offset 14, -4
 1262 0002 0546     		mov	r5, r0
 383:Src/control.c ****     int buff_yaw = yawrate_tgt.dir * yawrate_tgt.velocity - Control_Side_Wall() - gyro.velocity;
 1263              		.loc 1 383 0
 1264 0004 104A     		ldr	r2, .L91
 1265 0006 92F90440 		ldrsb	r4, [r2, #4]
 1266 000a B2F90030 		ldrsh	r3, [r2]
 1267 000e 03FB04F4 		mul	r4, r3, r4
 1268 0012 FFF7FEFF 		bl	Control_Side_Wall
 1269              	.LVL124:
 1270 0016 07EE904A 		vmov	s15, r4	@ int
 1271 001a F8EEE77A 		vcvt.f32.s32	s15, s15
 1272 001e 37EEC00A 		vsub.f32	s0, s15, s0
 1273 0022 0A4B     		ldr	r3, .L91+4
 1274 0024 D3ED007A 		vldr.32	s15, [r3]
 1275 0028 30EE670A 		vsub.f32	s0, s0, s15
 1276 002c FDEEC07A 		vcvt.s32.f32	s15, s0
 1277 0030 17EE903A 		vmov	r3, s15	@ int
 1278              	.LVL125:
 384:Src/control.c ****     //yawrate
 385:Src/control.c ****     if (buff_yaw > diff_yaw || buff_yaw < -diff_yaw)
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 31


 1279              		.loc 1 385 0
 1280 0034 9D42     		cmp	r5, r3
 1281 0036 02DB     		blt	.L88
 1282              		.loc 1 385 0 is_stmt 0 discriminator 1
 1283 0038 6D42     		negs	r5, r5
 1284 003a 9D42     		cmp	r5, r3
 1285 003c 02DD     		ble	.L87
 1286              	.L88:
 386:Src/control.c ****     {
 387:Src/control.c ****         flag_motor = FALSE;
 1287              		.loc 1 387 0 is_stmt 1
 1288 003e 044B     		ldr	r3, .L91+8
 1289              	.LVL126:
 1290 0040 0022     		movs	r2, #0
 1291 0042 1A70     		strb	r2, [r3]
 1292              	.L87:
 388:Src/control.c ****     }
 389:Src/control.c **** }...
 1293              		.loc 1 389 0
 1294 0044 38BD     		pop	{r3, r4, r5, pc}
 1295              	.L92:
 1296 0046 00BF     		.align	2
 1297              	.L91:
 1298 0048 00000000 		.word	yawrate_tgt
 1299 004c 00000000 		.word	gyro
 1300 0050 00000000 		.word	flag_motor
 1301              		.cfi_endproc
 1302              	.LFE134:
 1304              		.global	add_r
 1305              		.global	add_l
 1306              		.comm	flag_front_wall,1,1
 1307              		.comm	flag_wall,1,1
 1308              		.comm	flag_motor,1,1
 1309              		.comm	flag_motion_end,1,1
 1310              		.global	fwall_error_y
 1311              		.global	fwall_error_s
 1312              		.comm	y_before,4,4
 1313              		.comm	y_sum,4,4
 1314              		.comm	enc_before,4,4
 1315              		.comm	enc_sum,4,4
 1316              		.comm	yawrate_tim,6,4
 1317              		.comm	straight_tim,6,4
 1318              		.comm	yawrate_tgt,6,4
 1319              		.comm	straight_tgt,6,4
 1320              		.section	.bss.add_l,"aw",%nobits
 1321              		.set	.LANCHOR1,. + 0
 1324              	add_l:
 1325 0000 00       		.space	1
 1326              		.section	.bss.add_r,"aw",%nobits
 1327              		.set	.LANCHOR2,. + 0
 1330              	add_r:
 1331 0000 00       		.space	1
 1332              		.section	.bss.fwall_error_s,"aw",%nobits
 1333              		.align	2
 1334              		.set	.LANCHOR0,. + 0
 1337              	fwall_error_s:
 1338 0000 00000000 		.space	4
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 32


 1339              		.section	.bss.fwall_error_y,"aw",%nobits
 1340              		.align	2
 1341              		.set	.LANCHOR3,. + 0
 1344              	fwall_error_y:
 1345 0000 00000000 		.space	4
 1346              		.text
 1347              	.Letext0:
 1348              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1349              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1350              		.file 4 "Drivers/CMSIS/Include/core_cm4.h"
 1351              		.file 5 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 1352              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f405xx.h"
 1353              		.file 7 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1354              		.file 8 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1355              		.file 9 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\lib\\gcc\\arm-none-eabi
 1356              		.file 10 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
 1357              		.file 11 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 1358              		.file 12 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 1359              		.file 13 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_spi.h"
 1360              		.file 14 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 1361              		.file 15 "Inc/tim.h"
 1362              		.file 16 "Inc/filter.h"
 1363              		.file 17 "Inc/spi.h"
 1364              		.file 18 "Inc/interface.h"
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 33


DEFINED SYMBOLS
                            *ABS*:00000000 control.c
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:22     .text.PID_value:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:29     .text.PID_value:00000000 PID_value
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:113    .text.PID_value:00000070 $d
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:119    .text.Straight_Calc_fb:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:126    .text.Straight_Calc_fb:00000000 Straight_Calc_fb
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:276    .text.Straight_Calc_fb:000000e0 $d
                            *COM*:00000004 enc_before
                            *COM*:00000004 y_before
                            *COM*:00000006 straight_tgt
                            *COM*:00000006 straight_tim
                            *COM*:00000001 flag_motion_end
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:286    .text.Yawrate_Calc_fb:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:293    .text.Yawrate_Calc_fb:00000000 Yawrate_Calc_fb
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:444    .text.Yawrate_Calc_fb:000000e0 $d
                            *COM*:00000006 yawrate_tgt
                            *COM*:00000006 yawrate_tim
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:457    .text.Control_encoder:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:464    .text.Control_encoder:00000000 Control_encoder
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:592    .text.Control_encoder:000000e0 $d
                            *COM*:00000004 enc_sum
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:607    .text.Control_Side_Wall:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:614    .text.Control_Side_Wall:00000000 Control_Side_Wall
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:841    .text.Control_Side_Wall:00000180 $d
                            *COM*:00000001 flag_wall
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:856    .text.Control_gyro:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:863    .text.Control_gyro:00000000 Control_gyro
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1019   .text.Control_gyro:00000100 $d
                            *COM*:00000004 y_sum
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1033   .text.Control_Front_Wall:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1040   .text.Control_Front_Wall:00000000 Control_Front_Wall
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1156   .text.Control_Front_Wall:000000d0 $d
                            *COM*:00000001 flag_front_wall
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1172   .text.Control_pwm:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1179   .text.Control_pwm:00000000 Control_pwm
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1236   .text.Control_pwm:00000044 $d
                            *COM*:00000001 flag_motor
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1241   .text.Control_EmergencyStop:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1248   .text.Control_EmergencyStop:00000000 Control_EmergencyStop
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1298   .text.Control_EmergencyStop:00000048 $d
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1330   .bss.add_r:00000000 add_r
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1324   .bss.add_l:00000000 add_l
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1344   .bss.fwall_error_y:00000000 fwall_error_y
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1337   .bss.fwall_error_s:00000000 fwall_error_s
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1325   .bss.add_l:00000000 $d
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1331   .bss.add_r:00000000 $d
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1333   .bss.fwall_error_s:00000000 $d
C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s:1340   .bss.fwall_error_y:00000000 $d

UNDEFINED SYMBOLS
__aeabi_f2d
__aeabi_dmul
__aeabi_dadd
__aeabi_d2f
__aeabi_i2d
__aeabi_d2iz
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccyjPsda.s 			page 34


__aeabi_dsub
enc
LED_Control
sen_l
sen_r
gyro
sen_front
sen_fl
sen_fr
Motor_pwm
